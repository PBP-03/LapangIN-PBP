{% extends 'base.html' %}
{% block title %}Kelola Booking - LapangIN{% endblock %}
{% block content %}
<div class="min-h-screen bg-neutral-50">

  <!-- Header -->
  <div class="relative bg-white border-b border-neutral-200">
    <!-- gradient bar -->
    <div class="h-1 w-full bg-gradient-to-r from-primary-600 via-secondary-600 to-teal-600"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="py-6">
        <div class="flex items-center justify-between">
          <div>
            <div class="flex items-center gap-2 text-sm text-neutral-600 mb-2">
              <a href="/mitra/dashboard" class="hover:text-primary-600">Dashboard</a>
              <span>/</span>
              <span class="text-neutral-900">Kelola Booking</span>
            </div>
            <h1 class="text-2xl font-display font-bold text-neutral-900">Kelola Booking</h1>
            <p class="text-neutral-600">Kelola dan pantau semua booking lapangan Anda</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div id="bookingsLoading" class="flex justify-center items-center py-20">
    <div class="w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"></div>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden" id="bookingsContent">
    <!-- Filters and Stats -->
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
      <button onclick="filterByStatus('all')" class="stats-card" data-status="all">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-neutral-600">Total Booking</p>
            <p class="text-2xl font-bold text-neutral-900" id="statTotal">0</p>
          </div>
          <div class="w-10 h-10 bg-gradient-to-br from-primary-100 to-primary-200 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
          </div>
        </div>
      </button>

      <button onclick="filterByStatus('pending')" class="stats-card" data-status="pending">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-neutral-600">Pending</p>
            <p class="text-2xl font-bold text-yellow-600" id="statPending">0</p>
          </div>
          <div class="w-10 h-10 bg-yellow-100 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
        </div>
      </button>

      <button onclick="filterByStatus('confirmed')" class="stats-card" data-status="confirmed">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-neutral-600">Dikonfirmasi</p>
            <p class="text-2xl font-bold text-primary-600" id="statConfirmed">0</p>
          </div>
          <div class="w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
        </div>
      </button>

      <button onclick="filterByStatus('completed')" class="stats-card" data-status="completed">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-neutral-600">Selesai</p>
            <p class="text-2xl font-bold text-green-600" id="statCompleted">0</p>
          </div>
          <div class="w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
        </div>
      </button>

      <button onclick="filterByStatus('cancelled')" class="stats-card" data-status="cancelled">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-neutral-600">Dibatalkan</p>
            <p class="text-2xl font-bold text-red-600" id="statCancelled">0</p>
          </div>
          <div class="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </div>
        </div>
      </button>
    </div>

    <!-- Additional Filters -->
    <div class="bg-white rounded-2xl shadow-lg border border-neutral-200 p-4 mb-6">
      <div class="flex flex-wrap items-end gap-4">
        <div class="flex-1 min-w-[200px]">
          <label class="block text-sm text-neutral-600 mb-1">Venue</label>
          <select id="venueFilter" onchange="applyFilters()"
            class="w-full px-4 py-2 rounded-xl border border-neutral-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500 focus:outline-none">
            <option value="">Semua Venue</option>
          </select>
        </div>
        <div class="flex-1 min-w-[200px]">
          <label class="block text-sm text-neutral-600 mb-1">Tanggal</label>
          <input type="date" id="dateFilter" onchange="applyFilters()"
            class="w-full px-4 py-2 rounded-xl border border-neutral-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500 focus:outline-none">
        </div>
        <div class="flex items-end">
          <button onclick="clearFilters()"
            class="inline-flex items-center justify-center px-5 py-2.5 rounded-xl border border-neutral-300 text-neutral-700 hover:bg-neutral-100 transition-colors">
            Reset Filter
          </button>
        </div>
      </div>
    </div>

    <!-- Bookings List -->
    <div class="bg-white rounded-2xl shadow-lg border border-neutral-200 overflow-hidden">
      <div class="p-6 border-b border-neutral-200 bg-gradient-to-r from-primary-50 to-white">
        <h2 class="text-lg font-semibold text-neutral-900">Daftar Booking</h2>
      </div>

      <!-- Table -->
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-neutral-50 border-b border-neutral-200">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Customer</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Venue & Lapangan</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Tanggal & Waktu</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Durasi</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Total</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Status</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Pembayaran</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase">Aksi</th>
            </tr>
          </thead>
          <tbody id="bookingsTable" class="bg-white divide-y divide-neutral-200">
            <!-- Bookings will be loaded here -->
          </tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div id="emptyBookings" class="p-12 text-center hidden">
        <div class="w-16 h-16 bg-neutral-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
          </svg>
        </div>
        <h3 class="text-neutral-900 font-medium mb-2">Belum ada booking</h3>
        <p class="text-neutral-600 text-sm">Booking akan muncul di sini setelah customer melakukan pemesanan</p>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div id="bookingsError" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center hidden">
    <div class="w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
    </div>
    <h3 class="text-neutral-900 font-medium mb-2">Gagal memuat data booking</h3>
    <p class="text-neutral-600 text-sm mb-4">Terjadi kesalahan saat memuat data</p>
    <button onclick="window.location.reload()"
      class="inline-flex items-center justify-center px-6 py-3 bg-primary-600 text-white rounded-xl font-semibold hover:bg-primary-700 transition-colors shadow">
      Coba Lagi
    </button>
  </div>
</div>

<!-- Booking Detail Modal -->
<div id="bookingDetailModal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-6">
  <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] flex flex-col shadow-2xl">
    <div class="p-6 border-b border-neutral-200 flex-shrink-0 bg-gradient-to-r from-primary-50 to-white">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-display font-bold text-neutral-900">Detail Booking</h2>
        <button onclick="closeBookingModal()" class="text-neutral-400 hover:text-neutral-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
    <div id="bookingDetailContent" class="p-6 overflow-y-auto flex-1">
      <!-- Content will be loaded here -->
    </div>
  </div>
</div>

<style>
/* Kartu stats ala LapangIN */
.stats-card {
  @apply bg-white rounded-2xl border border-neutral-200 p-4 text-left transition-all hover:border-primary-300 hover:shadow-lg cursor-pointer;
}
.stats-card.active {
  @apply border-primary-500 ring-2 ring-primary-100;
}
</style>
{% endblock %}

{% block script %}
<script>
let bookingsData = [];
let venuesData = [];
let currentStatusFilter = 'all';
let currentVenueFilter = '';
let currentDateFilter = '';

// Load data on page load
document.addEventListener('DOMContentLoaded', async function() {
  await loadVenues();
  await loadBookings();
});

async function loadVenues() {
  try {
    const response = await makeAjaxRequest('/api/venues/');
    if (response.success) {
      venuesData = response.data;
      populateVenueFilter();
    }
  } catch (error) {
    console.error('Error loading venues:', error);
  }
}

function populateVenueFilter() {
  const select = document.getElementById('venueFilter');
  select.innerHTML = '<option value="">Semua Venue</option>';
  venuesData.forEach(venue => {
    select.innerHTML += `<option value="${venue.id}">${venue.name}</option>`;
  });
}

async function loadBookings() {
  try {
    let url = '/api/bookings/';
    const params = new URLSearchParams();
    if (currentStatusFilter !== 'all') params.append('status', currentStatusFilter);
    if (currentVenueFilter) params.append('venue_id', currentVenueFilter);
    if (currentDateFilter) params.append('date', currentDateFilter);
    if (params.toString()) url += '?' + params.toString();

    const response = await makeAjaxRequest(url);
    if (response.success) {
      bookingsData = response.data.bookings;
      renderBookings(bookingsData);
      updateStats(response.data.statistics);
      document.getElementById('bookingsLoading').classList.add('hidden');
      document.getElementById('bookingsContent').classList.remove('hidden');
    }
  } catch (error) {
    console.error('Error loading bookings:', error);
    document.getElementById('bookingsLoading').classList.add('hidden');
    document.getElementById('bookingsError').classList.remove('hidden');
  }
}

function updateStats(stats) {
  document.getElementById('statTotal').textContent = stats.total;
  document.getElementById('statPending').textContent = stats.pending;
  document.getElementById('statConfirmed').textContent = stats.confirmed;
  document.getElementById('statCompleted').textContent = stats.completed;
  document.getElementById('statCancelled').textContent = stats.cancelled;

  document.querySelectorAll('.stats-card').forEach(card => card.classList.remove('active'));
  document.querySelector(`.stats-card[data-status="${currentStatusFilter}"]`)?.classList.add('active');
}

function renderBookings(bookings) {
  const table = document.getElementById('bookingsTable');
  const emptyState = document.getElementById('emptyBookings');

  if (bookings.length === 0) {
    table.innerHTML = '';
    emptyState.classList.remove('hidden');
    return;
  }

  emptyState.classList.add('hidden');
  table.innerHTML = bookings.map(booking => `
    <tr class="hover:bg-neutral-50">
      <td class="px-6 py-4">
        <div>
          <p class="text-sm font-medium text-neutral-900">${booking.customer_name}</p>
          <p class="text-xs text-neutral-600">${booking.customer_phone || '-'}</p>
        </div>
      </td>
      <td class="px-6 py-4">
        <div>
          <p class="text-sm font-medium text-neutral-900">${booking.venue_name}</p>
          <p class="text-xs text-neutral-600">${booking.court_name}</p>
        </div>
      </td>
      <td class="px-6 py-4">
        <div>
          <p class="text-sm text-neutral-900">${formatDate(booking.booking_date)}</p>
          <p class="text-xs text-neutral-600">${booking.start_time} - ${booking.end_time}</p>
        </div>
      </td>
      <td class="px-6 py-4 text-sm text-neutral-900">
        ${parseFloat(booking.duration_hours)} jam
      </td>
      <td class="px-6 py-4 text-sm font-medium text-neutral-900">
        Rp ${parseInt(booking.total_price).toLocaleString('id-ID')}
      </td>
      <td class="px-6 py-4">
        <span class="inline-flex px-2 py-1 text-xs font-medium rounded-full ${getBookingStatusClass(booking.booking_status)}">
          ${getBookingStatusText(booking.booking_status)}
        </span>
      </td>
      <td class="px-6 py-4">
        <span class="inline-flex px-2 py-1 text-xs font-medium rounded-full ${getPaymentStatusClass(booking.payment_status)}">
          ${getPaymentStatusText(booking.payment_status)}
        </span>
      </td>
      <td class="px-6 py-4">
        <button onclick="viewBookingDetail('${booking.id}')" class="text-primary-600 hover:text-primary-700 text-sm font-medium">
          Detail
        </button>
      </td>
    </tr>
  `).join('');
}

function filterByStatus(status) {
  currentStatusFilter = status;
  document.getElementById('bookingsLoading').classList.remove('hidden');
  document.getElementById('bookingsContent').classList.add('hidden');
  loadBookings();
}

function applyFilters() {
  currentVenueFilter = document.getElementById('venueFilter').value;
  currentDateFilter = document.getElementById('dateFilter').value;
  document.getElementById('bookingsLoading').classList.remove('hidden');
  document.getElementById('bookingsContent').classList.add('hidden');
  loadBookings();
}

function clearFilters() {
  currentStatusFilter = 'all';
  currentVenueFilter = '';
  currentDateFilter = '';
  document.getElementById('venueFilter').value = '';
  document.getElementById('dateFilter').value = '';
  document.getElementById('bookingsLoading').classList.remove('hidden');
  document.getElementById('bookingsContent').classList.add('hidden');
  loadBookings();
}

async function viewBookingDetail(bookingId) {
  try {
    const response = await makeAjaxRequest(`/api/bookings/${bookingId}/`);
    if (response.success) showBookingDetail(response.data);
  } catch (error) {
    showNotification('Gagal memuat detail booking', 'error');
  }
}

function showBookingDetail(booking) {
  const content = document.getElementById('bookingDetailContent');
  content.innerHTML = `
    <div class="space-y-6">
      <!-- Customer Info -->
      <div>
        <h3 class="text-sm font-medium text-neutral-900 mb-3">Informasi Customer</h3>
        <div class="bg-neutral-50 rounded-xl p-4 space-y-2 border border-neutral-200">
          <div class="flex justify-between">
            <span class="text-sm text-neutral-600">Nama</span>
            <span class="text-sm font-medium text-neutral-900">${booking.customer_name}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-sm text-neutral-600">Email</span>
            <span class="text-sm font-medium text-neutral-900">${booking.customer_email}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-sm text-neutral-600">Telepon</span>
            <span class="text-sm font-medium text-neutral-900">${booking.customer_phone || '-'}</span>
          </div>
        </div>
      </div>

      <!-- Booking Info -->
      <div>
        <h3 class="text-sm font-medium text-neutral-900 mb-3">Informasi Booking</h3>
        <div class="bg-neutral-50 rounded-xl p-4 space-y-2 border border-neutral-200">
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Venue</span><span class="text-sm font-medium text-neutral-900">${booking.venue_name}</span></div>
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Lapangan</span><span class="text-sm font-medium text-neutral-900">${booking.court_name}</span></div>
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Tanggal</span><span class="text-sm font-medium text-neutral-900">${formatDate(booking.booking_date)}</span></div>
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Waktu</span><span class="text-sm font-medium text-neutral-900">${booking.start_time} - ${booking.end_time}</span></div>
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Durasi</span><span class="text-sm font-medium text-neutral-900">${parseFloat(booking.duration_hours)} jam</span></div>
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Total Harga</span><span class="text-sm font-medium text-primary-600">Rp ${parseInt(booking.total_price).toLocaleString('id-ID')}</span></div>
          ${booking.notes ? `
          <div class="pt-2 border-t border-neutral-200">
            <span class="text-sm text-neutral-600">Catatan</span>
            <p class="text-sm text-neutral-900 mt-1">${booking.notes}</p>
          </div>` : ''}
        </div>
      </div>

      <!-- Status Info -->
      <div>
        <h3 class="text-sm font-medium text-neutral-900 mb-3">Status</h3>
        <div class="bg-neutral-50 rounded-xl p-4 space-y-2 border border-neutral-200">
          <div class="flex justify-between items-center">
            <span class="text-sm text-neutral-600">Status Booking</span>
            <span class="inline-flex px-2 py-1 text-xs font-medium rounded-full ${getBookingStatusClass(booking.booking_status)}">
              ${getBookingStatusText(booking.booking_status)}
            </span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-sm text-neutral-600">Status Pembayaran</span>
            <span class="inline-flex px-2 py-1 text-xs font-medium rounded-full ${getPaymentStatusClass(booking.payment_status)}">
              ${getPaymentStatusText(booking.payment_status)}
            </span>
          </div>
          ${booking.cancellation_reason ? `
          <div class="pt-2 border-t border-neutral-200">
            <span class="text-sm text-neutral-600">Alasan Pembatalan</span>
            <p class="text-sm text-neutral-900 mt-1">${booking.cancellation_reason}</p>
          </div>` : ''}
        </div>
      </div>

      ${booking.payment ? `
      <!-- Payment Info -->
      <div>
        <h3 class="text-sm font-medium text-neutral-900 mb-3">Informasi Pembayaran</h3>
        <div class="bg-neutral-50 rounded-xl p-4 space-y-2 border border-neutral-200">
          <div class="flex justify-between"><span class="text-sm text-neutral-600">Metode</span><span class="text-sm font-medium text-neutral-900">${booking.payment.method}</span></div>
          ${booking.payment.transaction_id ? `<div class="flex justify-between"><span class="text-sm text-neutral-600">ID Transaksi</span><span class="text-sm font-medium text-neutral-900">${booking.payment.transaction_id}</span></div>` : ''}
          ${booking.payment.paid_at ? `<div class="flex justify-between"><span class="text-sm text-neutral-600">Dibayar pada</span><span class="text-sm font-medium text-neutral-900">${formatDateTime(booking.payment.paid_at)}</span></div>` : ''}
          ${booking.payment.has_proof ? `
          <div class="pt-2 border-t border-neutral-200">
            <span class="text-sm text-neutral-600 block mb-2">Bukti Pembayaran</span>
            <img src="${booking.payment.proof_url}" alt="Bukti Pembayaran" class="w-full max-w-sm rounded-lg border border-neutral-200">
          </div>` : ''}
        </div>
      </div>` : ''}

      <!-- Actions -->
      ${booking.booking_status === 'pending' ? `
      <div class="flex gap-3">
        <button onclick="updateBookingStatus('${booking.id}', 'confirmed')" class="inline-flex items-center justify-center px-5 py-2.5 bg-primary-600 text-white rounded-xl font-semibold hover:bg-primary-700 transition-colors flex-1">
          Konfirmasi Booking
        </button>
        <button onclick="cancelBooking('${booking.id}')" class="inline-flex items-center justify-center px-5 py-2.5 rounded-xl border border-neutral-300 text-neutral-700 hover:bg-neutral-100 transition-colors flex-1">
          Batalkan
        </button>
      </div>` : ''}

      ${booking.booking_status === 'confirmed' ? `
      <div class="flex gap-3">
        <button onclick="updateBookingStatus('${booking.id}', 'completed')" class="inline-flex items-center justify-center px-5 py-2.5 bg-primary-600 text-white rounded-xl font-semibold hover:bg-primary-700 transition-colors flex-1">
          Tandai Selesai
        </button>
        <button onclick="cancelBooking('${booking.id}')" class="inline-flex items-center justify-center px-5 py-2.5 rounded-xl border border-neutral-300 text-neutral-700 hover:bg-neutral-100 transition-colors flex-1">
          Batalkan
        </button>
      </div>` : ''}
    </div>
  `;
  document.getElementById('bookingDetailModal').classList.remove('hidden');
}

async function updateBookingStatus(bookingId, newStatus) {
  try {
    const response = await makeAjaxRequest(`/api/bookings/${bookingId}/`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json','X-CSRFToken': getCookie('csrftoken')},
      body: JSON.stringify({ booking_status: newStatus })
    });
    if (response.success) {
      showNotification(`Status booking berhasil diubah menjadi ${getBookingStatusText(newStatus)}`, 'success');
      closeBookingModal(); loadBookings();
    }
  } catch (error) {
    showNotification('Gagal mengubah status booking', 'error');
  }
}

async function cancelBooking(bookingId) {
  const reason = prompt('Alasan pembatalan (opsional):');
  try {
    const response = await makeAjaxRequest(`/api/bookings/${bookingId}/`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json','X-CSRFToken': getCookie('csrftoken')},
      body: JSON.stringify({ booking_status: 'cancelled', cancellation_reason: reason || '' })
    });
    if (response.success) {
      showNotification('Booking berhasil dibatalkan', 'success');
      closeBookingModal(); loadBookings();
    }
  } catch (error) {
    showNotification('Gagal membatalkan booking', 'error');
  }
}

function closeBookingModal() {
  document.getElementById('bookingDetailModal').classList.add('hidden');
}

function getBookingStatusClass(status) {
  switch(status) {
    case 'pending': return 'bg-yellow-100 text-yellow-800';
    case 'confirmed': return 'bg-primary-100 text-primary-800';
    case 'completed': return 'bg-green-100 text-green-800';
    case 'cancelled': return 'bg-red-100 text-red-800';
    default: return 'bg-neutral-100 text-neutral-800';
  }
}

function getBookingStatusText(status) {
  switch(status) {
    case 'pending': return 'Pending';
    case 'confirmed': return 'Dikonfirmasi';
    case 'completed': return 'Selesai';
    case 'cancelled': return 'Dibatalkan';
    default: return status;
  }
}

function getPaymentStatusClass(status) {
  switch(status) {
    case 'paid': return 'bg-green-100 text-green-800';
    case 'unpaid': return 'bg-yellow-100 text-yellow-800';
    case 'refunded': return 'bg-neutral-100 text-neutral-800';
    default: return 'bg-neutral-100 text-neutral-800';
  }
}

function getPaymentStatusText(status) {
  switch(status) {
    case 'paid': return 'Lunas';
    case 'unpaid': return 'Belum Bayar';
    case 'refunded': return 'Dikembalikan';
    default: return status;
  }
}

function formatDate(dateString) {
  const date = new Date(dateString);
  return date.toLocaleDateString('id-ID', { year: 'numeric', month: 'short', day: 'numeric' });
}
function formatDateTime(dateString) {
  const date = new Date(dateString);
  return date.toLocaleString('id-ID', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
}
</script>
{% endblock %}
